<div class="container mt-5" *ngIf="showForm">
  <h2 class="mb-4 text-primary">Account Inquiry</h2>

  <form [formGroup]="form" (ngSubmit)="submit()">
    <!-- Bank Selection -->
    <div class="mb-3">
      <label for="bank" class="form-label fw-bold">Select Bank</label>
      <select formControlName="bank" id="bank" class="form-select" required>
        <option value="" disabled>Select a bank</option>
        <option *ngFor="let bank of bankList" [value]="bank.code">
          {{ bank.name }}
        </option>
      </select>
      <div class="text-danger" *ngIf="form.get('bank')?.touched && form.get('bank')?.invalid">
        Bank is required.
      </div>
    </div>

    <!-- Account Number -->
    <div class="mb-3">
      <label for="accountNumber" class="form-label fw-bold">Account Number</label>
      <input
        type="text"
        id="accountNumber"
        class="form-control"
        formControlName="accountNumber"
        placeholder="Enter account number"
        required
      />
      <div class="text-danger" *ngIf="form.get('accountNumber')?.touched && form.get('accountNumber')?.invalid">
        Account number must be between 9 and 14 digits.
      </div>
    </div>

    <!-- Buttons -->
    <div class="d-flex gap-3">
      <button
        *ngIf="!inquiryFailed"
        type="submit"
        class="btn btn-primary"
        [disabled]="form.invalid || loading"
      >
        <span *ngIf="!loading">Submit Inquiry</span>
        <span *ngIf="loading">
          <span class="spinner-border spinner-border-sm me-2"></span>Submitting...
        </span>
      </button>

      <!-- Retry and Cancel shown only if failed -->
      <div *ngIf="inquiryFailed" class="d-flex gap-2">
        <button type="button" class="btn btn-warning" (click)="retry()">Retry</button>
        <button type="button" class="btn btn-danger" (click)="onCancel()">Cancel</button>
      </div>

      <button type="button" class="btn btn-secondary" (click)="clearForm()">
        Clear
      </button>
    </div>
  </form>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-danger mt-4">
    {{ errorMessage }}
  </div>
</div>

<!-- Invalid Authorization Message -->
<div *ngIf="!showForm" class="alert alert-warning mt-5">
  Invalid authorization. Account inquiry form cannot be displayed.
</div>
